<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>银行后台模拟系统</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; text-align: center; }
        input { margin: 5px; padding: 8px; width: 200px; }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; }
        #dashboard, #transactions, #history, #contacts, #limits { display: none; }
        table { width: 80%; margin: 10px auto; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 8px; text-align: center; }
    </style>
</head>
<body>

    <h2>银行后台模拟系统</h2>

    <div id="login">
        <label>用户名: <input id="username" type="text"></label><br>
        <label>密码: <input id="password" type="password"></label><br>
        <button onclick="login()">登录</button>
        <button onclick="register()">注册</button>
        <p id="login-message" style="color: red;"></p>
    </div>

    <div id="dashboard">
        <h3>欢迎, <span id="user"></span></h3>
        <button onclick="showTransactionPanel()">转账</button>
        <button onclick="showTransactionHistory()">查看交易记录</button>
        <button onclick="showContacts()">我的联系人</button>
        <button onclick="showLimits()">限额设置</button>
        <button onclick="logout()">退出</button>
    </div>

    <div id="transactions">
        <h3>转账系统</h3>
        <label>选择收款人:
            <select id="recipient"></select>
        </label><br>
        <label>转账金额: <input id="amount" type="number"></label><br>
        <button onclick="makeTransaction()">提交转账</button>
        <p id="transaction-message"></p>
    </div>

    <div id="contacts">
        <h3>我的联系人</h3>
        <table>
            <thead>
                <tr>
                    <th>联系人</th>
                </tr>
            </thead>
            <tbody id="contacts-table"></tbody>
        </table>
        <button onclick="addContact()">添加联系人</button>
    </div>

    <div id="limits">
        <h3>限额设置</h3>
        <label>日限额（行内转账）: <input id="daily-internal" type="number"></label><br>
        <label>日限额（跨行转账）: <input id="daily-external" type="number"></label><br>
        <label>日限额（电商付款）: <input id="daily-ecom" type="number"></label><br>
        <label>月限额（行内转账）: <input id="monthly-internal" type="number"></label><br>
        <label>月限额（跨行转账）: <input id="monthly-external" type="number"></label><br>
        <label>月限额（电商付款）: <input id="monthly-ecom" type="number"></label><br>
        <label>年限额（行内转账）: <input id="yearly-internal" type="number"></label><br>
        <label>年限额（跨行转账）: <input id="yearly-external" type="number"></label><br>
        <label>年限额（电商付款）: <input id="yearly-ecom" type="number"></label><br>
        <button onclick="saveLimits()">保存限额</button>
    </div>

    <script>
        let users = JSON.parse(localStorage.getItem("users")) || { "admin": "admin123" };
        let contacts = JSON.parse(localStorage.getItem("contacts")) || {};
        let limits = JSON.parse(localStorage.getItem("limits")) || {};
        let transactions = JSON.parse(localStorage.getItem("transactions")) || [];

        function login() {
            let username = document.getElementById("username").value.trim();
            let password = document.getElementById("password").value.trim();
            
            if (users[username] && users[username] === password) {
                document.getElementById("login").style.display = "none";
                document.getElementById("dashboard").style.display = "block";
                document.getElementById("user").innerText = username;

                if (!contacts[username]) {
                    contacts[username] = ["Nancy"];
                    localStorage.setItem("contacts", JSON.stringify(contacts));
                }
            } else {
                document.getElementById("login-message").innerText = "登录失败，用户名或密码错误！";
            }
        }

        function register() {
            let newUsername = prompt("请输入新用户名:");
            let newPassword = prompt("请输入密码:");

            if (!newUsername || !newPassword) {
                alert("用户名或密码不能为空！");
                return;
            }

            if (users[newUsername]) {
                alert("用户名已存在，请换一个！");
                return;
            }

            users[newUsername] = newPassword;
            contacts[newUsername] = ["Nancy"];
            localStorage.setItem("users", JSON.stringify(users));
            localStorage.setItem("contacts", JSON.stringify(contacts));

            alert("注册成功！请使用新账号登录。");
        }

        function showContacts() {
            document.getElementById("contacts").style.display = "block";
            let username = document.getElementById("user").innerText;
            let contactsTable = document.getElementById("contacts-table");
            contactsTable.innerHTML = "";

            contacts[username].forEach(contact => {
                let row = `<tr><td>${contact}</td></tr>`;
                contactsTable.innerHTML += row;
            });
        }

        function addContact() {
            let username = document.getElementById("user").innerText;
            let newContact = prompt("请输入联系人名称:");

            if (!newContact) return;

            if (!contacts[username].includes(newContact)) {
                contacts[username].push(newContact);
                localStorage.setItem("contacts", JSON.stringify(contacts));
                showContacts();
            } else {
                alert("联系人已存在！");
            }
        }

        function showLimits() {
            document.getElementById("limits").style.display = "block";
        }

        function saveLimits() {
            let username = document.getElementById("user").innerText;
            limits[username] = {
                daily: {
                    internal: document.getElementById("daily-internal").value,
                    external: document.getElementById("daily-external").value,
                    ecom: document.getElementById("daily-ecom").value
                },
                monthly: {
                    internal: document.getElementById("monthly-internal").value,
                    external: document.getElementById("monthly-external").value,
                    ecom: document.getElementById("monthly-ecom").value
                }
            };
            localStorage.setItem("limits", JSON.stringify(limits));
            alert("限额设置已保存！");
        }

        function logout() {
            document.getElementById("dashboard").style.display = "none";
            document.getElementById("login").style.display = "block";
        }
    </script>

</body>
</html>
